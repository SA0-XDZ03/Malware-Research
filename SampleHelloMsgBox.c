#include <windows.h>
#include <stdio.h>

/* Create Process Documentation
BOOL CreateProcessA(
    [in, optional]      LPCSTR                lpApplicationName,
    [in, out, optional] LPSTR                 lpCommandLine,
    [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes,
    [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes,
    [in]                BOOL                  bInheritHandles,
    [in]                DWORD                 dwCreationFlags,
    [in, optional]      LPVOID                lpEnvironment,
    [in, optional]      LPCSTR                lpCurrentDirectory,
    [in]                LPSTARTUPINFOA        lpStartupInfo,
    [out]               LPPROCESS_INFORMATION lpProcessInformation
);
*/

int main(void) {
STARTUPINFOW si = { 0 };
PROCESS_INFORMATION pi = { 0 };

/*W/L/A Are Encoding ANSI(A) & UNICODE(W) Issues & Ex is Extensibility*/
    MessageBoxW(
        NULL,
        L"Welcome to Windows API!", 
        L"Win32API Abuse",
        MB_YESNOCANCEL | MB_ICONASTERISK /*Check Message Box Functions*/
    );
    if (!CreateProcessW(
        L"C:\\Windows\\System32\\notepad.exe",
        NULL,
        NULL,
        NULL,
        FALSE,
        BELOW_NORMAL_PRIORITY_CLASS,
        NULL,
        NULL,
        &si,
        &pi
    )) {
        printf("(X) Process Creation Failed: Error: (%ld)", GetLastError());
        return EXIT_FAILURE;
    }
    printf("(+) Process Started: %ld", pi.dwProcessId);
    return EXIT_SUCCESS;
}